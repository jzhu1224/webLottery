<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>ç½‘é¡µæŠ½å¥–å°å·¥å…·</title>

    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="baidu-tc-verification" content="3e8294dabe46e8def7d4b790be59d4cc">

    <link rel="stylesheet" type="text/css" href="css/jquery-ui-1.7.2.custom.css">
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.7.2.custom.min.js"></script>

    <style type="text/css">
        body{
            margin: 0;
            padding: 0;
        }
        .ui-tabs .ui-tabs-panel {
            padding: 0;
        }

        table {
            margin: 12px auto;
            border-collapse: collapse;

        }

        th,
        td {
            padding: 4px 32px;
        }

        label {
            margin: 6px 0;
            font-size: 14px;
            font-weight: bold;
            display: block;
        }

        input[type=text] {
            width: 600px;
        }

        input {
            width: expression(this.type=="text"?"600px":"auto");
        }

        textarea {
            width: 600px;
        }

        #main {
            color: #000;
            margin: 0 auto;
            width: 980px;
        }

        #ui-tabs #ui-tabs-panel {
            padding: 0;
        }

        #event_title {
            color: #ff0;
            margin: 26px;
            padding: 0;
            font-size: 56px;
            text-align: center;
        }

        #event_title span {
            padding: 0 32px;
        }

        #rolling_board {
            color: #fff;
            line-height: 40px;
            font-size: 20px;
            font-weight: bold;
            margin: 16px auto;
            padding: 8px;
            width: 640px;
            text-align: center;
            /*            background: #fed07c;
            */
        }

        #current_step {
            line-height: 42px;
            font-size: 42px;
            font-weight: bold;
            color: #fff;
        }

        #tabs {
            padding: 0;
        }

        #tabs-1 {
            font-size: 14px;
            text-align: center;
        }

        #tabs-2,
        #tabs-3,
        #tabs-4 {
            /*            padding: 4px;
            */
            border: 1px solid #ccc;
        }

        #tabs-3 h3,
        #tabs-4 h3 {
            padding-left: 6px;
            border-left: 6px solid #c00;
        }

        #tabs-4 h2 {
            text-align: center;
        }

        #rotate_div {
            padding-top: 100px;
            min-height: 300px;
            padding-bottom: 50px;
        }

        #print_box {
            margin-top: 30px;
            font-weight: bold;
            font-size: 28px;
            width: 90%;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            color: #fff;
        }

        #print_box span {
            margin: 4px;
            color: #fff;
            font-size: 24px;
        }
    </style>
</head>

<body class="bg index">
<div id="container">
    <div id="wrapper" class="mh">
        <!--        <h2 style="text-align: center">åœ¨çº¿æŠ½å¥–</h2>-->
        <script type="text/javascript">
            var game;

            $(function () {
                $('#loading').hide();
                $('#tabs').slideDown('fast');
                $('#tabs').tabs();

                game = new Game();
                save_setting();
            });

            // ç»‘å®šå›è½¦é”®ç›˜æ“ä½œ
            $(document).keypress(function (e) {
                switch (e.which) {
                    case 13:
                        game.process();
                        break;
                }
            });

        </script>

        <div id="main">
            <div id="loading" style="text-align: center; display: none;">
                <h2>Loading...</h2>
            </div>

            <div id="tabs" style="display: block;" class="ui-tabs ui-widget ui-widget-content ui-corner-all">
                <!--                <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">-->
                <!--                    <li class="ui-corner-top ui-tabs-selected ui-state-active"><a href="#tabs-1">æŠ½å¥–</a></li>-->
                <!--                    <li class="ui-corner-top ui-state-default"><a href="#tabs-2">è®¾ç½®</a></li>-->
                <!--                    <li class="ui-corner-top ui-state-default"><a href="#tabs-3">ç»“æœ</a></li>-->
                <!--                    <li class="ui-corner-top ui-state-default"><a href="#tabs-4">å¸®åŠ©</a></li>-->
                <!--                </ul>-->

                <div id="tabs-1" style="background-color: rgb(189,6,4);"
                     class="ui-tabs-panel ui-widget-content ui-corner-bottom">
                    <h1 id="event_title"><span>æŠ½å¥–æ´»åŠ¨</span></h1>
                    <!--                    <img width="100px" style="margin: 0 2px 0 2px "-->
                    <!--          src="https://res.cloudinary.com/shenmanz/image/upload/v1578336465/shenma/event/zene/zene.png"/>-->
                    <h1 style="color: ivory; font-size: 48px">SILVERMOON</h1>
                    <div style="height: 120px; width: 976px;line-height: 120px;font-size: 42px; color: rgb(245, 205, 119)">
                        æ–°å¹´æ­£å½“çº¢ ä¸“é¼ æ–°å¹´ç¤¼æŠ½å¥–
                    </div>
                    <div style="width: 976px;font-size: 32px; color: rgb(245, 205, 119)">
                        ï¼ˆåŸºç£åŸï¼‰
                    </div>
                    <div id="rotate_div" style="display: block;">
                        <div><span id="current_step" style="display: none;">ä¸€ç­‰å¥–(1ä¸ª)</span></div>

                        <div id="rolling_board" style="display: none;"><span style="color: #f33">å‘˜å·¥L</span></div>

                        <div id="print_box" style="display: block;">press Enter to start</div>
                    </div>
                </div>
                <!-- /#tabs-1 -->

                <div id="tabs-2" style="background: #fff;"
                     class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
                    <label>æ´»åŠ¨æ ‡é¢˜</label>
                    <div><input type="text" name="title" value=""></div>

                    <label>å¥–é¡¹è®¾ç½®</label>
                    <div>æ¯è¡Œä¸€ä¸ªå¥–é¡¹, æ ¼å¼ä¸ºç«–çº¿åˆ†éš”çš„: å¥–é¡¹å|æ•°é‡|æ¯æ¬¡æŠ½å‡ ä¸ª|å¥–å“</div>
                    <textarea name="prizes" rows="6" cols="84">
æ–½åæ´›ä¸–å¥‡æ‰‹åŒ…|20|10|æ–½åæ´›ä¸–å¥‡æ‰‹åŒ…
                        </textarea>

                    <label>å€™é€‰äººåˆ—è¡¨</label>
                    <div>æ¯è¡Œä¸€äºº, æˆ–åŠè§’é€—å·åˆ†éš”</div>
                    <textarea name="candidates" rows="6" cols="84">
02102873247	é†‰è¯ºç®¬
02102955069	çˆ±æ—…æ¸¸çš„å°èš¯èš“
0211069960	Justin
02108409906	Miaoxue
0211847224	ç¿ (æ—¶å·®+4å°æ—¶ï¼‰
0210508574	ğŸ’maggieğŸ’—ğŸ­
0274569081	Helloé‘«å®é…±ï½
0221767723	Omeletteå·ğŸ³
0273978689	Dido
0212214620	æ—©æ—©ğŸ’‹MaggieğŸ‡³ğŸ‡¿æ¸¸èµ°æ–°è¥¿å…°
02102873447	å€¦å¯
02102955369	æ‰¯æ·¡ä½ çš„å–å¼„
0211098960	Cryâ†˜ï¸¶å¯‚å¯
02108409776	å·›å¿ƒ å·²å†·ç¬
0211845724	é¦™äº†ä¸€å£â€»
0210509874	ï¹Œæ„¿æ‘ºÃ Ğ¾éª¨
0274557081	ã‚ãŒå‚»ã‘ã 
0221760823	æˆ‘æ˜¯å¤§æ‘†ç¥
0273936689	è¿™èˆ¬æ— å¥ˆã€‚
0212299620	æåº¦åš£å¼ 
0212298785	æ—¥ä¸è½
                        </textarea>

                    <label>è·³åŠ¨æ—¶é—´é—´éš”</label>
                    <div><input type="text" name="interval" value="50" style="width: 50px;"> ms</div>

                    <label>èƒŒæ™¯å›¾ç‰‡</label>
                    <div>å¯ä»¥è¾“å…¥å›¾ç‰‡é“¾æ¥ä½¿ç”¨ç½‘ç»œä¸Šçš„å›¾ç‰‡, ä¹Ÿå¯ä»¥æŠŠå›¾ç‰‡æ‹·è´åˆ°å½“å‰ç›®å½•, æŠŠå›¾ç‰‡æ–‡ä»¶åå¡«å…¥å³å¯.</div>
                    <div><input name="background_image" type="text" value="3.jpg"></div>


                    <p><input type="button" value="ä¿å­˜" onclick="save_setting()"></p>
                </div>
                <!-- /#tabs-2 -->

                <div id="tabs-3" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
                    <h2>ä¸€ç­‰å¥–</h2>å‘˜å·¥L &nbsp;<br>
                    <h2>äºŒç­‰å¥–</h2>å‘˜å·¥M &nbsp;å‘˜å·¥H &nbsp;<br>
                    <h2>ä¸‰ç­‰å¥–</h2>å‘˜å·¥E &nbsp;å‘˜å·¥A &nbsp;å‘˜å·¥I &nbsp;å‘˜å·¥B &nbsp;<br></div>
                <!-- /#tabs-3 -->

                <div id="tabs-4" class="ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide">
                    <h2>æŠ½å¥–è½¯ä»¶</h2>
                    <p>åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œçš„æŠ½å¥–ç¨‹åº</p>

                    <h3>æ“ä½œæ–¹ä¾¿</h3>
                    <p>æŠ½å¥–è¿‡ç¨‹å…¨é”®ç›˜æ“ä½œ, åªéœ€è¦æŒ‰å›è½¦(Enter)é”®å³å¯, ç±»ä¼¼æ’­æ”¾PPTå¹»ç¯ç‰‡, éå¸¸ç®€å•.</p>

                    <h3>é…ç½®çµæ´»</h3>
                    <p>å¯é…ç½®çš„é€‰é¡¹æœ‰: æ´»åŠ¨æ ‡é¢˜, å¥–é¡¹, å€™é€‰äºº, æ‘‡å¥–æ—¶çš„è·³è½¬é€Ÿåº¦, èƒŒæ™¯å›¾ç‰‡. å…¶ä¸­, æ¯ä¸€ä¸ªå¥–é¡¹, å¯ä»¥ä¸€æ¬¡å¼€å®Œ, ä¹Ÿå¯ä»¥ä¸€æ¬¡åªå¼€ä¸€éƒ¨åˆ†. ä¾‹å¦‚, ä¸‰ç­‰å¥–ä¸€å…±6ä¸ª, æ¯æ¬¡åªå¼€2ä¸ª,
                        éœ€è¦å¼€3æ¬¡æ‰èƒ½å¼€å®Œä¸‰ç­‰å¥–, å¢åŠ å¨±ä¹æ€§. å›¾ç‰‡å¯ä»¥æ›´æ¢ä¸ºå¸¦è‡ªå·±å…¬å¸Logoçš„å›¾ç‰‡, ä»¥ä¾¿é€‚åº”å½“å‰èŠ‚æ—¥, æ‰€ä»¥, æœ¬æŠ½å¥–ç¨‹åºä»»ä½•èŠ‚æ—¥çš„ä»»ä½•ç±»ä¼¼çš„æŠ½å¥–èŠ‚ç›®éƒ½å¯ä½¿ç”¨.</p>

                    <h3>æŠ½å¥–æµç¨‹</h3>
                    <pre>
ç­‰å¾…å¼€å§‹
å¼€åœº(open): å¥–é¡¹ä»‹ç»
å¥–é¡¹å¾ªç¯: å¦‚æœå¤šäºä¸€ä¸ªå¥–é¡¹, åˆ™å¾ªç¯
	å¥–é¡¹å¼€åœº(step_open)
	æ‘‡å¥–å¾ªç¯: å¦‚æœä¸æ˜¯ä¸€æ¬¡å¼€å®Œä¸€ä¸ªå¥–é¡¹, åˆ™å¾ªç¯
		æ‘‡å¥–å¼€å§‹(rotate_start)
		æ‘‡å¥–ç»“æŸ(rotate_stop)
	å¥–é¡¹ç»“æŸ(step_close): å•é¡¹ä¸­å¥–åå•
é—­åœº(close)
                        </pre>
                </div>
                <!-- /#tabs-4 -->
            </div>

            <script type="text/javascript">
                function in_array(item, list) {
                    for (var i = 0; i < list.length; i++) {
                        if (item == list[i]) {
                            return true;
                        }
                    }
                    return false;
                }

                /**
                 * è¿”å›æŒ‡å®šå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•, å¦‚æœæ²¡æ‰¾åˆ°, è¿”å›-1;
                 */
                function array_find(list, item) {
                    for (var i = 0; i < list.length; i++) {
                        if (item == list[i]) {
                            return i;
                        }
                    }
                    return -1;
                }

                // ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ . è¿”å›æ–°æ•°ç»„.
                function array_del(list, item) {
                    var arr = [];
                    for (var i = 0; i < list.length; i++) {
                        if (item != list[i]) {
                            arr.push(list[i]);
                        }
                    }
                    return arr;
                }

                // ä»æ•°ç»„ä¸­åˆ é™¤å…ƒç´ . è¿”å›æ–°æ•°ç»„.
                function array_del_all(list, items) {
                    var arr = [];
                    for (var i = 0; i < list.length; i++) {
                        if (array_find(items, list[i]) == -1) {
                            arr.push(list[i]);
                        }
                    }
                    return arr;
                }

                /**
                 * æŠŠæ•°ç»„å½“ä½œç¯å½¢çš„, è¿”å›ä»startå¼€å§‹, ä¸€å…±countä¸ªå…ƒç´ .
                 * å¦‚æœcountå¤§äºæ•°ç»„é•¿åº¦, è¿”å›æ•´ä¸ªæ•°ç»„.
                 */
                function array_slice(list, start, count) {
                    var ret;

                    ret = list.slice(start, start + count);
                    if (ret.length < count) {
                        ret = ret.concat(list.slice(0, count - ret.length));
                    }

                    return ret;
                }

                // æ‰°ä¹±æ•°ç»„å…ƒç´ çš„é¡ºåº.
                function array_shuffle(list) {
                    var len = list.length;
                    for (var i = 0; i < len * 5; i++) {
                        var p1 = parseInt(len * Math.random());
                        var p2 = parseInt(len * Math.random());
                        var tmp = list[p1];
                        list[p1] = list[p2];
                        list[p2] = tmp;
                    }
                }

                /*
                çŠ¶æ€/åŠ¨ä½œ

                å¼€åœº(open)
                å¾ªç¯{
                    å¥–é¡¹å¼€åœº(step_open)
                    å¥–é¡¹æŠ½å¥–(rotate_start)
                    å¥–é¡¹æŠ½å¥–(rotate_stop)
                    å¥–é¡¹é—­åœº(step_close)
                }
                é—­åœº(close)

                */
                var Game = function () {
                    var self = this;

                    this.step = -1;
                    this.interval = 100;
                    this.rotate_index = 0;
                    self.action = 'open';

                    this.prizes = [];
                    this.candidates = [];
                    this.results = [];

                    this.init = function () {
                        this.step = 0;
                        this.stop = false;
                        this.rotate_index = 0;
                        self.action = 'open';
                        this.results = [];

                        for (var i = 0; i < self.prizes.length; i++) {
                            var p = self.prizes[i];
                            self.results[i] = [];
                        }

                        show_current_step('');
                        var str = "press 'Enter' to start";
                        str += '<br/><br/>';
                        print_box("press 'Enter' to start");

                        $('#rolling_board').hide();
                        $('#rotate_div').css('background', '');
                    }

                    this.reset = function () {
                        this.prizes = [];
                        this.candidates = [];
                        this.results = [];
                    }

                    this.process = function () {
                        show_results();

                        // å…ˆæ›´æ–°çŠ¶æ€å†æ‰§è¡Œå‡½æ•°
                        switch (self.action) {
                            case 'open':
                                self.action = 'step_open';
                                $('#rotate_div').hide();
                                on_open();
                                $('#rotate_div').fadeIn('slow');
                                break;
                            case 'close':
                                self.action = '';
                                on_close();
                                break;
                            case 'step_open':
                                self.action = 'rotate_start';
                                $('#rotate_div').hide();
                                on_step_open();
                                $('#rotate_div').fadeIn('fast');
                                break;
                            case 'step_close':
                                if (self.step == self.prizes.length) {
                                    self.action = 'close';
                                } else {
                                    self.action = 'step_open';
                                }
                                on_step_close();
                                break;
                            case 'rotate_start':
                                self.action = 'rotate_stop';
                                on_rotate_start();
                                break;
                            case 'rotate_stop':
                                on_rotate_stop();
                                break;
                            default:
                                save_setting();
                                break;
                        }
                    };
                }

                function on_open() {
                    // show_current_step('æ´»åŠ¨è¯´æ˜');

                    var str = '<table align="center">';
                    str += '<tr><th>å¥–é¡¹</th><th>æ•°é‡</th><th>å¥–å“</th></tr>\n';
                    for (var i = game.prizes.length - 1; i >= 0; i--) {
                        var p = game.prizes[i];
                        str += '<tr><td>' + p.name + '</td><td>' + p.num + '</td><td>' + p.award + '</td></tr>\n';
                    }
                    str += '</table>';
                    print_box(str);
                }

                function on_close() {
                    show_current_step('');

                    $('#print_box').hide();
                    var str = '';
                    str += '<span><b style="font-size: 62px;">closed</b><span><br/>';
                    print_box(str);
                    $('#print_box').fadeIn('slow');
                }

                function on_step_open() {
                    show_current_step();
                    print_box("press 'Enter' to start");
                    $('#rolling_board').html('...');
                }

                function on_step_close() {
                    var str = '';
                    str += '<span style="font-size: 20px">&nbsp;ä¸­å¥–åå•&nbsp;';
                    var r = game.results[game.step - 1].map((number) => number.replaceAll(/(?<=\d{3})\d(?=\d{4})/, "*"));
                    for (var n = 0; n < r.length; n++) {
                        if (n % 2 == 0) {
                            str += '<br/>' + r[n];
                        } else {
                            str += '&nbsp;<br/>&nbsp;' + r[n];
                        }
                    }
                    str += '</span>';

                    print_box(str);
                    $('#rolling_board').slideUp('normal');
                }

                function on_rotate_start() {
                    $('#rolling_board').slideDown('normal');

                    game.interval = parseInt($('input[name=interval]').val());

                    game.stop = false;
                    game.rotate_index = 0;

                    // æ‰“ä¹±é¡ºåº
                    array_shuffle(game.candidates);

                    rotate_run();

                    show_current_step();
                    print_box("press 'Enter' to stop");
                }


                function on_rotate_stop() {
                    // ç­‰ä¸€æ®µéšæœºæ—¶é—´å†åœæ­¢.
                    game.interval += parseInt(0.9 * game.interval);
                    setTimeout('game.stop=true', 230 + parseInt(230 * Math.random()));
                    //game.stop = true;
                }


                function rotate_run() {
                    String.prototype.replaceAll = function (FindText, RepText) {
                        regExp = new RegExp(FindText, "g");
                        return this.replace(regExp, RepText);
                    };
                    var num_a = game.prizes[game.step].num_a_time;
                    var size = game.prizes[game.step].num - game.results[game.step].length;
                    if (size > num_a) {
                        size = num_a;
                    }

                    var arr = array_slice(game.candidates, game.rotate_index, size);
                    $('#rolling_board').html(arr.map((number) => number.replaceAll(/(?<=\d{3})\d(?=\d{4})/, "*")).join(' '));

                    game.rotate_index += num_a;
                    if (game.rotate_index >= game.candidates.length) {
                        game.rotate_index -= game.candidates.length;
                    }

                    if (game.stop) {
                        game.action = 'rotate_start';

                        game.results[game.step] = game.results[game.step].concat(arr);
                        game.candidates = array_del_all(game.candidates, arr);

                        show_results();
                        print_box("press 'Enter' to continue");

                        if (game.results[game.step].length == game.prizes[game.step].num) {
                            game.step++;
                            game.action = 'step_close';
                        }

                        var h = '<span style="color: black; font-size: 20px">' + $('#rolling_board').html() + '</span>';
                        $('#rolling_board').html(h)
                    } else {
                        setTimeout('rotate_run()', game.interval);
                    }
                }


                function show_current_step(str) {
                    if (str == undefined) {
                        var found = game.results[game.step].length;
                        var all = game.prizes[game.step].num;
                        var num_a = game.prizes[game.step].num_a_time;
                        var b = (num_a + found) > all ? all : (num_a + found);

                        var str = game.prizes[game.step].name;
                        if (num_a != all) {
                            str += ', ' + (found + 1) + '-' + all;
                        }
                    }
                    if (str == '') {
                        $('#current_step').hide('fast');
                    } else {
                        $('#current_step').html(str);
                        $('#current_step').show();
                    }
                }

                function print_box(str) {
                    if (str == undefined) {
                        var str = '<span>';
                        var r = game.results[game.step];
                        for (var n = 0; n < r.length; n++) {
                            str += r[n] + ' &nbsp;';
                        }
                        str += '</span>';
                    }
                    if (str == '') {
                        $('#print_box').hide('fast');
                    } else {
                        $('#print_box').html(str);
                        $('#print_box').show();
                    }
                }

                function show_results() {
                    String.prototype.replaceAll = function (FindText, RepText) {
                        regExp = new RegExp(FindText, "g");
                        return this.replace(regExp, RepText);
                    };
                    var str = '';
                    for (var i = game.results.length - 1; i >= 0; i--) {
                        str += '<h2>' + game.prizes[i].name + '</h2>';
                        var r = game.results[i];
                        for (var n = 0; n < r.length; n++) {
                            str += r[n] + '<br/>';
                        }
                        str += '<br/>';
                    }

                    str += '---------------------------------------------------------------------------------------------------------<br/>';

                    var str2 = '';

                    for (var i = game.results.length - 1; i >= 0; i--) {
                        str2 += '<h2>' + game.prizes[i].name + '</h2>';
                        var r = game.results[i];
                        for (var n = 0; n < r.length; n++) {
                            str2 += r[n] + '<br/>';
                        }
                        str2 = str2.replaceAll(/(?<=\d{3})\d(?=\d{4})/, "*");
                        str2 += '<br/>';
                    }
                    str += str2;

                    $('#tabs-3').html(str);
                }


                function save_setting() {
                    game.reset();

                    var ps = $.trim($('textarea[name=prizes]').val()).split('\n');
                    for (var i = 0; i < ps.length; i++) {
                        var p = $.trim(ps[i]);
                        if (p.length == 0) {
                            continue;
                        }
                        var ex = p.split('|');
                        var prize = {
                            name: $.trim(ex[0]),
                            num: parseInt($.trim(ex[1])),
                            num_a_time: parseInt($.trim(ex[2])),
                            award: $.trim(ex[3])
                        };
                        game.prizes.push(prize);
                    }

                    var ps = $.trim($('textarea[name=candidates]').val()).replace(/,/g, '\n').split('\n');
                    for (var i = 0; i < ps.length; i++) {
                        var p = $.trim(ps[i]);
                        if (p.length == 0) {
                            continue;
                        }
                        game.candidates.push(p);
                    }

                    $('#event_title span').html($('input[name=title]').val());
                    //$('#tabs-1').css('background', 'url(' + $('input[name=background_image]').val() + ') center center no-repeat');

                    game.init();
                }
            </script>

        </div>

    </div>
</div>
</body>

</html>
